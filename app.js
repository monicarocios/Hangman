const game = () => {
	let pScore = 10;
	let guessed = [];
	let wordStatus = null;
	let alphabet = [];
	let randomWord = '';

	let spaceWords = [
		'antimatter',
		'asteroid',
		'earth',
		'gravity',
		'meteorite',
		'neptune',
		'pulsar',
		'quasar',
		'supernova',
		'universe',
		'interstellar'
	];

	// Computer randomly selects a word from the space words array
	let generateRandomWord = () => {
		randomWord = spaceWords[Math.floor(Math.random() * spaceWords.length + 1)];
	};

	// Start the Game
	const startGame = () => {
		const playbtn = document.getElementById('intro-btn');
		const introScreen = document.querySelector('.jumbotron');
		const gameScreen = document.querySelector('.game');

		playbtn.addEventListener('click', () => {
			introScreen.classList.add('fadeOut');
			gameScreen.classList.add('fadeIn');
		});

		console.log(randomWord);
		document.getElementById('guesses-left').innerHTML = 'Guesses left: ' + pScore;
		// console.log(Math.floor(Math.random() * spaceWords.length + 1));
		drawCanvas();
	};

	const printButtons = () => {
		alphabet = [
			'a',
			'b',
			'c',
			'd',
			'e',
			'f',
			'g',
			'h',
			'i',
			'j',
			'k',
			'l',
			'm',
			'n',
			'o',
			'p',
			'q',
			'r',
			's',
			't',
			'u',
			'v',
			'w',
			'x',
			'y',
			'z'
		];

		for (i = 0; i < alphabet.length; i++) {
			// let name = document.createTextNode(alphabet[i]);
			let btn = document.createElement('button');
			btn.type = 'button';
			btn.className = 'btn btn-light';

			// create a text node
			let name = document.createTextNode(alphabet[i]);
			btn.appendChild(name);
			btn.id = btn.innerHTML;
			document.getElementById('alphabet').appendChild(btn);
			checkGuess(btn, randomWord);
		}
	};

	const checkGuess = (letterClicked, randomWord) => {
		letterClicked.addEventListener('click', () => {
			console.log(letterClicked.id);
			guessed.indexOf(letterClicked.id) === -1 ? guessed.push(letterClicked.id) : null;
			// Returns - 1 if the item is not found, so if letter clicked not found in guessed array already, push it to the array
			document.getElementById(letterClicked.id).setAttribute('disabled', true);
			// console.log(guessed);

			if (randomWord.indexOf(letterClicked.id) >= 0) {
				guessedCorrectly(randomWord);
				document.getElementById('results').innerHTML = 'You Guessed Correctly!';
				youWin(wordStatus, randomWord);
			} else {
				pScore--;
				animate(pScore);
				document.getElementById('guesses-left').innerHTML = 'Guesses left: ' + pScore;
				document.getElementById('results').innerHTML = 'Wrong Letter :(';
				youLose();
			}
		});
	};

	const youWin = (wordStatus, randomWord) => {
		if (wordStatus === randomWord) {
			alert('YOU WON!! The word was: ' + randomWord);
			reset();
		}
	};

	const youLose = () => {
		if (pScore === 0) {
			alert('You Lost lil bit... The word was: ' + randomWord);
			reset();
		}
	};

	// Create blanks on the screen for word to be guessed
	// how it works:
	// using random word generated by computer, function splits it by each letter and then runs through each of them
	// it then goes to the guessed array
	// if letter of random word exists in guessed array, then return the letter
	// if not, then it leaves a blank

	function guessedCorrectly(randomWord) {
		wordStatus = randomWord.split('').map((letter) => (guessed.indexOf(letter) >= 0 ? letter : ' _ ')).join('');

		document.getElementById('blanks').innerHTML = wordStatus;
	}

	// Animate Man
	const animate = (pScore) => {
		drawArray[pScore]();
	};

	// Hangman
	const drawCanvas = () => {
		var canvas = document.getElementById('myCanvas');
		var ctx = canvas.getContext('2d');
		ctx.beginPath();
		ctx.clearRect(0, 0, 400, 500);
		ctx.fillStyle = 'rgba(255, 255, 255, 0.87)';
		ctx.fillRect(0, 0, 400, 500);
		ctx.linewidth = 2;
	};

	head = function() {
		var canvas = document.getElementById('myCanvas');
		var ctx = canvas.getContext('2d');
		ctx.beginPath();
		ctx.arc(125, 110, 20, 0, Math.PI * 2, true);
		ctx.stroke();
	};

	draw = function($pathFromx, $pathFromy, $pathTox, $pathToy) {
		var canvas = document.getElementById('myCanvas');
		var ctx = canvas.getContext('2d');
		ctx.moveTo($pathFromx, $pathFromy);
		ctx.lineTo($pathTox, $pathToy);
		ctx.stroke();
	};

	frame1 = function() {
		draw(50, 50, 50, 350);
		draw(50, 350, 250, 350);
	};

	// frame2 = function() {
	// 	draw(50, 350, 250, 350);
	// };

	frame3 = function() {
		draw(50, 50, 125, 50);
	};

	frame4 = function() {
		draw(125, 50, 125, 90);
	};

	torso = function() {
		draw(125, 130, 125, 210);
	};

	rightArm = function() {
		draw(125, 140, 90, 200);
	};

	leftArm = function() {
		draw(125, 140, 160, 200);
	};

	rightLeg = function() {
		draw(125, 215, 90, 300);
	};

	leftLeg = function() {
		draw(125, 210, 160, 300);
	};

	emptyFrame = function() {
		draw();
	};

	let drawArray = [ emptyFrame, rightLeg, leftLeg, rightArm, leftArm, torso, head, frame4, frame3, frame1 ];

	// const drawHead = (drawingObject) => {
	// 	drawingObject.beginPath();
	// 	drawingObject.arc(60, 25, 10, 0, Math.PI * 2, true);
	// 	drawingObject.stroke();

	// if (pScore === 14) {
	// 	drawBase(ctx);
	// } else if (pScore === 13) {
	// 	drawHead(ctx);
	// }
	// };

	// need to figure out if splitting different parts of hangman
	// body into functions works, or just using if else statements
	// for pscore and hangman bosy works better

	generateRandomWord();
	startGame();
	printButtons();
	guessedCorrectly(randomWord);

	// draw different parts of hangman when guess incorrectly
	// functions divided by parts

	const reset = () => {
		pScore = 10;
		guessed = [];
		wordStatus = null;
		document.getElementById('alphabet').innerHTML = '';
		randomWord = '';

		var canvas = document.getElementById('myCanvas');
		var ctx = canvas.getContext('2d');
		ctx.clearRect(0, 0, 400, 500);
		// ctx.beginPath();
		ctx.fillStyle = 'rgba(255, 255, 255, 0.87)';
		ctx.fillRect(0, 0, 400, 500);

		document.getElementById('results').innerHTML = 'Guess a letter to start';

		generateRandomWord();
		startGame();
		printButtons();
		guessedCorrectly(randomWord);
	};
};

game();
